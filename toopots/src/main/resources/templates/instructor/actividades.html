<!DOCTYPE html>
<html layout:decorate="~{fragments/base}"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="/css/estilos-tabla.css"
	th:href="@{/css/estilos-tabla.css}" />
<title>Mis Actividades</title>
<style>
body {
	background-color: #f0f0f0;
}

#main {
	margin-top: 30px;
	margin-bottom: 30px;
}

.add-actividad {
	padding-top: 6px;
	float: right;
}

tbody > tr > th, td {
	text-transform: capitalize;
}

.tbl-header th:last-child {
	width: 250px;
}
</style>
</head>
<body>
	<div layout:fragment="content">
		<!-- Main -->
		<div id="main">
			<div class="container">
				<div th:if="${#lists.isEmpty(actividades)}">No has creado ninguna actividad</div>
				<div th:unless="${#lists.isEmpty(actividades)}">
					<div class="titulo_form">
						<header class="table-header">
							<span class="header-title">Mis Actividades</span>
							<a href="actividad/add">
								<span class="far fa-plus-square add-actividad">
                                	Añadir Actividad
                            	</span></a>
						</header>
					</div>

					<div class="row">
						<div class="col-12">
							<table class="table table-hover">
								<thead class="tbl-header">
									<tr>
										<th scope="col">Nombre</th>
										<th class="text-center">Fecha y Hora</th>
										<th class="text-center">Estado</th>
										<th class="text-center">Min. Asistentes</th>
										<th class="text-center">Asistentes</th>
										<th scope="col"></th>
									</tr>
								</thead>
								<tbody >
									<tr th:each="actividad: ${#lists.sort(actividades.keySet())}" th:if="${actividad.estado == 'abierta'}">
										<th th:text="${actividad.nombre}" scope="row"></th>
										<td
											th:text="${#dates.format(actividad.fecha, 'dd/MM/yyyy') + ' ' + #dates.format(actividad.horaDeEncuentro, 'HH:mm')}"
											class="text-center"></td>
										<td th:text="${actividad.estado}" class="text-center"></td>
										<td th:text="${actividad.minAsistentes}" class="text-center"></td>
										<td
											th:text="${actividades.get(actividad) + '/'+ actividad.maxAsistentes}"
											class="text-center"></td>
										<td><a th:if="${actividad.estado != 'cancelada'}"
											th:href="@{/instructor/actividad/{idActividad}(idActividad=${actividad.idActividad})}"
											class="btn btn-primary">Más Info</a>
											<a th:if="${actividad.estado != 'cancelada'}" href="#" class="open-modal btn btn-danger"
											data-toggle="modal" data-target="#modal-cancelar"
											th:attr="data-target='#modal-cancelar'+${actividad.idActividad}">Cancelar</a>

										<!-- Modal -->
										<div class="modal fade" tabindex="-1" role="dialog"
											aria-labelledby="exampleModalCenterTitle" aria-hidden="true"
											th:id="modal-cancelar+${actividad.idActividad }">
											<div class="modal-dialog modal-dialog-centered"
												role="document">
												<div class="modal-content">
													<div class="modal-header">
														<h5 class="modal-title" id="exampleModalCenterTitle">Cancelar
															Reserva</h5>
														<button type="button" class="close" data-dismiss="modal"
															aria-label="Close">
															<span aria-hidden="true">&times;</span>
														</button>
													</div>
													<div class="modal-body">
															<div class="body-wrapper" th:if="${actividad.estado != 'cancelada'}">
															¿Estás seguro de que quieres cancelar la
															actividad "<span
																style="font-weight: bold; text-transform: capitalize;"
																th:text="${actividad.nombre}"></span>" con
															fecha "<span
																style="font-weight: bold; text-transform: capitalize;"
																th:text="${#dates.format(actividad.fecha, 'dd/MM/yyyy')}"></span>"
															y hora "<span
																style="font-weight: bold; text-transform: capitalize;"
																th:text="${#dates.format(actividad.horaDeEncuentro, 'HH:mm')}"></span>"?.
															</div>
													</div>
													<div class="modal-footer">
														<button type="button" class="btn btn-secondary"
															data-dismiss="modal">No</button>
														<a th:if="${actividad.estado != 'cancelada'}"
															th:href="@{/actividad/cancelar/{idActividad}(idActividad=${actividad.idActividad})}"
															class="btn btn-danger"> Si </a>
												</div>
											</div>
										</div>
										<!-- /Modal -->
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- /Main -->
	</div>
</body>
</html>